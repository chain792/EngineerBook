<% content_for(:title, @book.title) %>
<div class="container mt-3">
  <div class="row">
    <div class="col-md-10 offset-md-1">
      <h2><%= @book.title %></h2>
      <p><%= @book.authors.pluck(:name).join(', ') %> (著)</p>
      <p><small class="text-muted"><%= "発売日: #{@book.published_date}" unless @book.published_date.blank? %></small></p>
      <div class="card p-3">
        <div class="row g-0">
          <div class="col-4 col-md-3">
              <%= image_tag @book.book_image.url, class: 'img-fluid border' %><br>
              <p class="m-3"><%= link_to '詳細を見る', @book.info_link, target: '_blank' %></p>
          </div>
          <div class="col-8 col-md-9">
            <div class="ms-2">
              <% if current_user.own?(@book) %>
                <div class="dropdown float-end">
                  <button class="btn dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="bi bi-gear-fill fs-5"></i>
                  </button>
                  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuButton1">
                    <li><%= link_to '編集する', edit_book_path(@book), class: 'dropdown-item' %></li>
                    <li>
                      <%= link_to '削除', book_path(@book), class: 'dropdown-item text-danger', method: :delete, data: {confirm: t('defaults.message.delete_confirm', item: t('defaults.review'))} %>
                    </li>
                  </ul>
                </div>
              <% end %>
              <h5 class="mb-2">レビューした人</h5>
              <%= image_tag @book.user.avatar.url, class: 'rounded-circle ps-1', size: '40x40' %>
              <%= @book.user.name %>
              <h5 class="mt-4 mb-2">レビュー内容</h5>
              <p class="card-j"><%= simple_format @book.body %></p>
              <p class="card-tejxt mb-2"><small class="text-muted"><%= l @book.created_at, format: :long %></small></p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- コメント一覧 -->
  <%= render 'comments/comments', comments: @comments %>
  <!-- コメント投稿 -->
  <%= render 'comments/form', book: @book, comment: @comment %>
</div>